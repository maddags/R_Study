---
output: html_document
---
# 시계열(Time Series)분석

## 1.1 시계열  

시간에 따라 변하는 확률량(Random Quantity) or 확률구조(Probability Structure)을 의미함.

![](https://image.slidesharecdn.com/timeseriesanalysis-180726011933/95/-4-638.jpg?cb=1532568257)

***

## 1.2 시계열 자료의 종류

**분해 시계열**이란 시계열에 영향을 주는 일반적인 요인을 시계열에서 분리해 분석하는 방법을 말한다.

시계열을 구성하는 요소는 다음과 같다.

1. 불규칙요인(Irregular Factor)

    시간에 따른 규칙적인 움직임과는 무관하게 랜던함 원인에 의한 변동성분

![](C:/Users/madda/Documents/동아리/R문서(개인)/시계열분석/시계열자료 그림/불규칙성분 시계열그래프.png)

2. 추세요인(Trend Factor)

    관측값이 지속적으로 증가/감소하는 추세(선형/지수형 등등)를 갖는 경우의 변동
    
![](C:/Users/madda/Documents/동아리/R문서(개인)/시계열분석/시계열자료 그림/추세성분 시계열그래프.png)

3. 계절성분(Seasonal Component)

    주별, 월별, 계절별과 같이 주기적인 성분에 의한 변동
    
![](C:/Users/madda/Documents/동아리/R문서(개인)/시계열분석/시계열자료 그림/계절성분 시계열그래프.png)

4. 순환성분(Cyclical Component)

    주기적인 변화를 가지나 변화가 계절에 의한 것이 아니고, 주기가 긴 경우의 변동/경기순환
    
추세성분, 계절성분, 순환성분을 통틀어 체계적성분(Systematic Component)라 한다.

***

## 1.3 시계열 분석 

확률 구조 사이에 존재하는 종속성, 상관성 등 여러 확률적,통계적 성징들을 파악하는것.

이를 바탕으로 확률현상의 미래 형태를 예측하는 통계적 접근법

목표는 분석을 통해 미래의 값을 **예측**하는 것과 **시스템 이해 및 제어**를 하는 것

(단, 예측을 할 때는 다음의 조건 필요)

 * 과거의 패턴이 있어야함
 * 미래에서도 지속된다는 가정하에 분석
 * 추세성분, 순환성분, 계절변동성분 제거 필수

***

## 1.4 시계열 분석법

1. 예측(forecast)을 위한 분석법
+ 추세분석(Trend Analysis)
+ 평활법(Smoothing Method)
+ 분해법(Decomposition Method)
+ 자기회귀누적이동평균(AutoRegressive Integrated Moving Average : ARIMA)모형
+ 이분산자기회귀모형(AutoRegressive Conditional Heterskedasticity)


2. 시스템 이해와 제어를 위한 분석법
+ 스펙트럼분석(Spectral Analysis)
+ 개입분석(Intervention Analysis)
+ 전이함수모형(Transfer Function Model)
+ 자기상관오차를 갖는 회귀모형(AutoRegressive Error Model)


    접근 분야에 따른 두 가지 접근법
    1. 시간 영역 분석(Time Domain Analysis)
    + 적당한 모수적 회귀모형을 가정하고, 추론에서는 모형의 차수와 회귀계수를 추정
    + 관측자료가 제한된 상태에서 미래를 예측(ARIMA모형이 효과적)
    + 예시)
      + 자기상관함수(Autocorrelation Function) 등을 이용한 시간에 따른 상관 정도를 파악
      + 추세분석, 평활법 분해법, ARIMA모형, 전이함수모형 자기상관오차를 갖는 회귀모형
      + 이분산 모형(GRACH) 모형
      + Long Memory Process
    
    2. 주파수 영역 분석(Frequancy Domain Analysis)
    + 주어진 시계열이 평균이나 분산등이 비교적 안정한 정상시계열을 대상
    + sine/cosine 함수와 같이 강한 주기를 띠는 함수들의 일차결합의 형태
    + 이러한 결합모형의 종속성을 주도하는 주기를 구별해내는 방법
    + 예시)
      + 푸리에분석(Fourier Analysis)
        + 태양 흑점의 수 or 밀 가격지수
        + 스펙트럼 밀도함수의 추정
        + 공학/이학분야의 자료와 같이 시계열이 일정한 패턴을 따르는 정상적인 경우
      + 파엽분석(Wavelet Analysis)

***
    
    
## 1.5 모형적합 3단계 및 예측시스템

1st 모형의 식별단계(Model Identification)

2nd 모형의 추정(Model Estimation)

3rd 모형의 진단(Model Diagnostic Checking)

![](C:/Users/madda/Documents/동아리/R문서(개인)/시계열분석/시계열자료 그림/시계열 분석 과정.png)

***

## 2.1 시계열의 특성

시계열분석을 위해서는 정상성(Stationary)을 만족해야한다.

정상성이란 시점에 상관없이 시계열의 특성이 일정하는 것을 의미한다.

    정상성
    1. 평균이 일정하다.
    2. 분산이 시점에 의존하지 않는다.
    3. 공분산은 단지 시차에만 의존하고 시점 자체에는 의존하지 않는다.
    
안정적 시계열이라고 하면은 어떤 조건에서 정상성을 띄고 있는 시계열 자료이다.

![](C:/Users/madda/Documents/동아리/R문서(개인)/시계열분석/시계열자료 그림/시계열 정상성.png)
...................................................................................................................................................................................................

정상성은 강정상성(Strongly Stationary), 약정상성(Weakly Stationary)로 구분된다.

### 강정상성 정의(Strongly Stationary Definition)

만약 확률과정 {$X_t | t∈Ð$}에 대하여, 

어떤 ($t_1$,...,$t_n$) ∈ Ð(n∈N)인 모든 결합분포($X_{t1}$,...,$X_{tn}$) $∝=$ 결합분포($X_{t1+h}$,...,$X_{tn+h}$)이 

$F_X$(X = $X_{t1}$,...,$X_{tn}$) = $F_X$(X = $X_{t1+h}$,...,$X_{tn+h}$)와 같다면, 

확률과정 $X_t$를 강정상성이라 부른다.($∝=$ 는 수렴한다는 뜻)

다시 말하면, 모든 확률과정 $X$가 모든 $t+n$에서의 값에서 h시점을 더해 이동하였을때, 이동한 값과 기존의 값이 동일하다는 의미. 여기서 모든 t에 대해서 임으로 $X+t$의 분포가 동일함을 의미한다.

직관적으로 시간의 변화에도 확률적 구조가 **변하지 않음**을 의미한다.

(확률적 구조(Probability Strucutre) : 확률과정의 평균,분산-공분산 등을 포함한 모든 적률과 결합확률 분포등으로 설명되는 확률적 성질을 말함)


### 약정상성 정의(Weakly Stationary Definition)

{$X_t$|$t∈Ð$} 확률과정이 $E|X_∞|^2 < ∞$ 일 때,

* $1^{st}$ 모든 t에 대하여, $μ_{X(t)} = E(X_t) = μ$ (시점 t가 변해도 평균은 같다.)
* $2^{nd}$ $C_X (t,s) = Cov(X_t,X_s) = E[(X_t - μ)(X_s-μ)]$ = $C_s(s-t)$ 

(공분산은 반드시 두 시차의 차에서만 의존, s-t는 시차(h))

2가지를 만족하면, $X_t$는 약정상성이라한다.

...................................................................................................................................................................................................

위에서 정상성 조건 하나라도 만족을 하지 못하면 비정상 시계열이라고 부른다.

대부분의 시계열 자료는 비정상 시계열 자료이다.

즉, 비정상 시계열 자료는 정상성을 만족하도록 데이터를 정상 시계열 자료로 만든 후에시계열 분석을 수행해야 한다.

자료에서 이상점(Outlier)는 제거하고 추세를 보이는(평균이 일정하지 않는) 경우에는 **차분(Difference)**을 통해 정상 시계열로 바꾸고, 시간에 따라 분산이 일정지 않은 경우에는 **변환(Transformation)**을 통해서 정상 시계열로 바꿀 수 있다.

차분은 현 시점의 자료값에서 전 시점의 자료값을 빼는 것을 말한다.

일반적으로 차분은 현시점에서 바로 전 시점의 자료값을 빼는 것을 의미하며, 여러 시점 전의 자료를 빼는 것을 계절차분(Seasonal Difference)라고함.

```{r echo = F}
ts_1 <- ts(data = AirPassengers, start = c(1949,1), end = c(1960,12), frequency =12)
ts_2 <- diff(ts_1)
ts_3 <- log(ts_1)
ts_4 <- diff(ts_3)

par(mfrow = c(2,2))
plot(ts_1,main =" 비정상성 데이터",ylab="",sub = "1번째 그래프")
plot(ts_2,main =" 일정한 평균 데이터",ylab="", sub = "2번째 그래프")
plot(ts_3,main =" 일정한 분산 데이터",ylab="", sub = "3번째 그래프")
plot(ts_4,main =" 정상성 데이터",ylab="", sub = "4번째 그래프")

```

위의 그래프들처럼 다양한 형태의 그래프가 나올 수 있다.


1번째 그래프 : 시간이 지남에 따라 점점 y값은 상승하고 있다. 하지만 y값의 상승률이 일정하지 않고, 시간에 따라 다르므로 분산과 평균이 일정치 않으므로 비정상 그래프

2번재 그래프 : y값은 sin함수처럼 0을 기준으로 증가폭은 넓어지지만 평균은 대략 0에 가깝다. 하지만 분산은 0을 기준으로 증가폭이 일정치 않고, 평균은 일정하다.

3번째 그래프 : y값이 점점 증가한다. 평균도 일정치 않지만(y값이 증가함으로), y축이 주기를 띄면서 증가함으로 분산은 일정하다.

4번째 그래프 : sin함수의 계형을 가지면서, 평균은 대략 0으로 일정하고, 등락도 또한 일정하게 증가/감소하고 있다. 따라서 정상성을 만족하는 그래프.

...................................................................................................................................................................................................

비정상시계열의 정상화

1. 분산이 일정하지 않은 경우
  + 로그 변환
  + 제곱근 변환
  + Box-Cow 변환

2. 추세를 가지는 경우
  + 결정적 추세 --> 분해법 또는 추세항 모형에 포함
  + 확률적 추세(Dickey-Fuller의 단위근 검정)  --> 차분

3. 계절성을 가지는 경우
  + 결정적 계절추세 -> 계절 추세항 모형에 포함
  + 확률적 계절추세(계절형 단위근 검정) -> 계절차분

...................................................................................................................................................................................................



***

## 2.2 시계열모형

### 1) 자기회귀 모형(Autoregressive Model,AR)

AR모형은 p시점의 자료가 현재 시점의 자료에 영향을 준다는 시계열 모형

p는 유한개의 과거의 관측값을 나타냄.

AR(1)모형 : $X_t = aX_{t-1} + e_t$, $e_t$ ~ $iid~ N(0,σ^2)$

AR(p)모형 : $X_t$ = $a_1X_{t-1} + a_2X_{t-2} + ... + a_pX_{t-p} + e_t$, $e_t$ ~ $iid ~ N(0,σ^2)$

해석은 시계열 $X_t$에서 시점 t의 관측치를 나타냄. $X_t$의 관측치가 과거 관측치 $X_{t-1},X_{t-2},...,X_{t-p}$들에 의해 설명이 될 때, AR(p)모형을 따른다.

AR(1)에서 보면, 
 
 $X_t$ = 현재 시점의 정상 시계열,
 
 $aX_{t-1}$ = 한시점 이전(p=1)의 정상 시계열,
 
 $e_t$ = 현재 시점의 잔차 를 의미한다.

AR(p)에서 보면,

$a_pX_{t-p}$ = p시점에서의 정상 시계열,

$a_p$ = p시점에서 정상 시계열의 상수로, p시점이 현재 시점에 어느 정도 영향을 주는지 나타내는 모수이다.


또한 오차항은 서로 독립이고 유한인 평균과 분산을 갖는 동일 분포를 따르는(Independent Identically Distrbuted,iid) 확률변수로 백색잡음과정(white nosie process, 대표적 정상 시계열)라고 한다.

자기회귀모형인지 판단하기 위한 모형 식별을 위해서 자료에서 자기상관함수(ACF, Auto-Correlation Function)과 부분자기상관함수(PACF, Partial Auto-Correlation Function)을 이용한다.

자기상관함수는 동일한 변수의 서로 다른 시간 차이(time lag)를 두고 분석하는 것이다.

![](C:/Users/madda/Documents/동아리/R문서(개인)/시계열분석/시계열자료 그림/자기상관계수 vs 상관계수.PNG)

ACF가 빨리 떨어지면 보통 정상적인 시계열이고, ACF가 늦게 떨어지면 데이터가 부족하거나 어떤 문제가 있는 것.

(ARIMA를 통해 추세,절편 등이 있는지 판단해야함.)

...................................................................................................................................................................................................

자기상관함수는 다음과 같다.

(1) $$c_k = \frac{1}{n} \sum_{t=1}^{n-k} (x_t-μ)(x_{t-k}-μ) = Cov(x_t,x_{t-k})$$ 


(2) $$γ_k = \frac{c_k}{c_0} = \frac{Cov(x_t,x_{t-k})}{\sqrt{Var(x_t)Var(x_{t-K})}}$$

$x_t$ : t 시점에서의 시계열 자료

k : 시차(time lage ; k : 0 ~ K), n : 시계열 길이, μ : 시계열 x의 평균

$c_k$ : 자기공분산, $γ_k$ : 자기상관계수

자기상관함수는 주어진 시계열 자료의 자기 선형성과 기억효과를 나타낸다. 

즉 시계열 자료가 짧은 지연시간(time lag)에 0의 값을 수렴하게 되면 자기선형성이 약하고 반대로 자기 선형성이 강하면 자기상관함수는 천천히 감소하는 양상을 보이고 긴 지연시간(time lag)에 0 이상의 값을 갖게 될 것이다.

이때 AR모형이 정상성을 띄기 위해서는 자기상관계수의 값에 제한 조건이 붙는다. 

(-1 < γ_k < 1)

$y_k$가 위의 범위에 속하지 않는다면 정상성을 만족하지 못하고 발산하는 형태의 Random Walk가 된다.

**자기상관계수 신뢰구간** 

자기상관계수 신뢰구간 = $\pm\frac{Z_{1-\frac{α}{2}}}{\surd{N}}$

(N는 자료의 개수, Z는 표준정규분포의 누적분포함수, α는 유의수준)

보통 신뢰구간(임계선)을 넘어가면 유의한 시차가 되는 것이고, 넘어가지 못하면 자기상관계수가 없는 것으로 본다. 즉, 선을 넘어가면 유의한 것으로 보고, 넘어자지 않으면 유의하지 않은 것으로 보면 된다.

...................................................................................................................................................................................................

편자기상관함수(pcaf)는 어느 시점과 현재 시점에의 상관성을 분석하는데 있어 중간 시점들의 영향을 고려하지 않고 현재 시점과 해당 시점만을 가지고 상관성을 분석한다. 

이를 통해 AR모형의 차수(order)를 추정하는 방법 중 하나이다.

사이값들의 영향을 없애기 위해 $X_t$값과 $X_{t-1},...,X_{t-k+1}$라는 k-1개의 값들(독립변수)사이의 선형 회귀 분석을 실행한다.

$\hat{X_t} = β_1X_{t-1} + β_2X_{t-2} + ... + β_{k-1}X_{t-k+1}$

β는 선형 회귀 분석의 결과로 얻어진 계수이다.

ACF와 마찬가지로 신뢰수준을 넘어가면 유의하다고 보고, 넘지 않으면 유의하지 안하다고 생각하면 된다.

AR모형에서는 자기회귀차수에 해당하는 시차에 두드러진 뒤, 이 시차 이후(K+1)에는 모두 0으로 절단된다. 

***

### 2) 이동 평균 모형(Moving Average)

MA(q)모형은 확률과정의 현재 값 $Y_t$이 백색 잡음의 현재 값 $ε_t$부터 q시간 지연된 $ε_{t-q}$까지 1개 항의 선형 가중합인 확률과정 모형이다.

$Y_t = ε_t + θ_1ε_{t-1} + ... + θ_qε_{t-q}$

즉 쉽게 말하자면, 현재시점(t)에서 q시점전까지의 오차가 데이터에 영향을 준다고 가정한 모형이다.

또한 MA모형은 백색잡음의 결합이므로 언제나 정상성을 만족한다.

MA모형의 ACF/PCAF의 형태는 AR모형과 반대로 ACF는 k+1시점 이후 절단된 형태가 되고, PCAF는 점차 감소하는 형태를 띄게 된다.

### 3) ARMR 모형

ARMR모형은 AR모형과 MA모형의 특징을 모두 가지고 있는 모형이다.

즉, p개의 시점과 q개의 백색잡음의 선형 조합으로 현재의 값을 조정한다.

$X_t = a_1X_{t-1} + ... + a_pX_{t-p} + θ_1ε_{t-1} + ... +θ_qε_{t-q}$

ARMA(p,q)의 정상상태 조건은 AR(p)조건과 동일($|a| < 1$)하다.

θ는 정상조건에 영향을 주지 않는다.

...................................................................................................................................................................................................

#### ARMA 모형 시물레이션
```{r echo = F}
set.seed(123)
vec <- numeric(0)
n = 1000
vec <- rnorm(1)
for(i in 1:n)
  vec <- c(vec, vec[length(vec)] + rnorm(1, mean = , sd = 1))
plot(vec)
```

위의 그래프를 보면 비정상적을 띄는 그래프이다. 따라서 정상성을 띄는 데이터로 바꿔주어야한다.

평균과 분산 둘다 일정하지 않으므로 차분,변환을 둘다 해주어야한다.

```{r echo = F}

vec_diff <- diff(vec, differences = 1)
plot(vec_diff, type = "l")
```

평균과 분산이 어느정도 일정하게 그래프가 차분되었다.

ACF/PACF를 알아보자.

정상성을 띄지 않는 경우 ACF가 느리게 감소지만, 정상성을 띄는 경우 ACF가 빠르게 0으로 떨어진다.



```{r echo = F}
par(mfrow = c(1,2))
acf(vec_diff, lag.max = 50)
pacf(vec_diff, lag.max = 50)
```





### 4) ARIMA 모형

ARIMA모형은 시계열 분석을 하기 위한 방법 중 하나로, ARMA모형보다도 더 일반적으로 데이터에 사용할 수 있는 분석기법이다. AR,MA모형에 차분까지 더해진 기법으로 주로 ARIMA(p,d,q)로 표현한다. 

(p : AR(p), q: MA(q), d : 차분횟수)

ARIMA모형으로 분석하기 위해서 앞선 방법들과 동일하게 먼저 분석할 데이터가 정상성을 띄는 시계열인지 아닌지 부터 확인한다.

비정상성 데이터는 차분을 통해서 정상화를 해준다.(이때 i가 정해진다.)

정상화된 데이터를 가지고 ACF/PACF를 해주거나 비정상적 데이터를 auto.arima를 통해 최적의 ARIMA(p,d,q)모형을 찾는다. 이때 AIC를 비교해주어서 찾으면 된다.

auto.arima를 사용하여 모형을 찾아내면 간편하지만, auto.arima도 특정 알고리즘에 의해 순차적으로 접근하는 것으로 ACF/PACF로 사용하여 직접 판단하면서 찾을 시, 더 좋은 모형도 발견할 수 있다.

...................................................................................................................................................................................................

**자동화된 ARIMA 모델링을 위한 힌드만-칸다카르(Hyndman-Khandakar) 알고리즘**

1. KPSS검정을 반복하여 차분횟수 0 <= d <= 2를 결정한다.

2. 데이터를 d번 차분(differencing)한 후에 AICc를 최소화하여 p,q를 고른다.
  + 초기에는 4개의 모델로 진행한다.
      + ARIMA(0,d,0) / ARIMA(2,d,2) / ARIMA(1,d,0) / ARIMA(0,d,1)
      + d = 2 아니면, 상수를 포함합니다. d <= 1 이면, 덧셈 모델도 맞춥니다.
      + 상수가 없는 ARIMA(0,d,0)
  + 위에서 맞춘 (AICc값이 가장 작은) 가장 좋은 모델을 "현재 모델"로 둡니다.
  + 현재 모형의 변형을 고려합니다.
      + 현재 모델에서 p or q $\pm1$을 해준다.
  +이중 가중 좋은 모델 선택
  
더 좋은 모형이 나올때까지 반복한다.

auto.arima(approximation = T/F : 몇 가지 근사 과정 사용의 유무 -> F :일시 최소 AICc를 못구함)

참조 : https://otexts.com/fppkr/arima-r.html

...................................................................................................................................................................................................





## 3. R에서 시계열 분석하기

일단 분석에 앞서 자료의 형태를 바꿔야한다. 보통 자료들은 vec, data.frame, ...과 같은 형태로 되어있을 것이다. 데이터형태를 ts형태로 바꿔야한다. 데이터들 중 시간에 따른 자료값들을 선택해서 하면된다.

이때 사용하는 함수는 ts()이다.

ts(data, start = , frequency =)로 사용되어지는데 start 시작하는 데이터의 날짜를 입력하면 된다.

ex(1년일때는 연도, 월일때는 c(연도,월))

frequency는 한번 사이클이 도는 횟수를 말한다.

1년 = 1, 분기 = 4, 월 = 12, 주 = 52... 과 같이 설정하면 된다.

```{r echo = T}
set.seed(100)
dt1 <- numeric(0)
dt1 <- 500
n = 240
for(i in 1:n) 
  dt1 <- c(dt1, dt1[length(dt1)] + rnorm(1, mean = 1, sd = 6))

dt1

dt1 <- ts(dt1, start = c(2020,1), frequency = 4)
plot(dt1, type = "l",
     ylab = "")
```

위의 데이터는 난수 240개를 발생시켜서 임의의 데이터를 ts데이터로 바꾸어 그래프로 나타낸 것이다.

ts형태는 총 60년동안 분기별 데이터로 변환하였다.

위의 그래프는 일정한 분산/평균을 갖기 않으므로 차분을 해서 정상성르 띄게 만들어야한다.

```{r echo = T}
dt1_diff <- diff(dt1, differences = 1)
plot(dt1_diff, type = "l", ylab = "")
```

1시점 차분해준 그래프를 보면 평균은 일정하고, 분산도 거의 일정하게 나온다.

그럼 acf/pacf를 통해 그래프를 보자.

```{r eho = T}
library(dplyr)
library(forecast)
par(mfrow = c(1,2))
dt1 %>% diff(lag = 1) %>% ggtsdisplay()
```

위 그래프를 지금까지 배운 내용으로만 설정하자면

acf에서 시차1 이후 유의미한 값이 없어지기 때문에 MA(1) 모형이고, pcaf를 봐도 시차1 이후에 유의미한 값이 없어지기 때문에 AR(1) 모형이라고도 할 수 있다.

그럼 ARIMA로 적용해서 AIC값을 살펴 보자.

```{r echo =T}
arima(dt1, order = c(1,1,0))
arima(dt1, order = c(0,1,1))
arima(dt1, order = c(1,1,1))
```

3가지 ARIMA모형 중 AIC값이 가장 작은 값은 ARIMA(1,1,0) 모델이다.

그럼 일단은 만든 모델 중 ARIMA(1,1,0)모형이 가장 알맞은 모델이라고 할 수 있다.

그럼 auto.arima로 햇을때는 어떻게 모형이 나올까?

```{r echo = T}
auto.arima(dt1)
```

auto.arima로 했을때는 ARIMA(0,1,1)(0,0,1)[4] with drift 모형으로 나온다.

위에 직접 아리마로 계산을 했을때랑 auto.arima랑 했을때랑 많은 차이가 나온다.

계절,추세,주기와 같은 분해시계열의 영향을 많이 받은 것이므로 4가지 요인을 제거한 뒤에 다시 해보자.

먼저 데이터 dt1의 분해시계열을 알아보자.

```{r echo = T}
dt1_decompose <- decompose(dt1)
plot(dt1_decompose)
```

그래프에서 각각 4가지 분해시계열을 빼고 다시 그래프를 추정해보자.

```{r echo = T}
dt1_non_seasonal <- dt1 - dt1_decompose$seasonal
dt1_non_trend <- dt1 - dt1_decompose$trend
dt1_non_random <- dt1 - dt1_decompose$random
plot(dt1_non_seasonal, type = "l", main = "No Seasonal", ylab = "")
plot(dt1_non_trend, type = "l", main = "No Trend", ylab = "")
plot(dt1_non_random, type = "l", main = "No Random", yalb = "")
```

계절성을 없앤 데이터를 가지고 다시 차분을 해주자.

```{r echo = T}
dt1_non_seasonal2 <- diff(dt1_non_seasonal, differences = 1)
plot(dt1_non_seasonal2, type = "l", ylab = "",main = "diff(1)")
```

```{r echo = T}
ggtsdisplay(dt1_non_seasonal2)
arima(dt1_non_seasonal2, order = c(1,1,0))
arima(dt1_non_seasonal2, order = c(0,1,1))
arima(dt1_non_seasonal2, order = c(1,1,1))
```

계절요인의 유무에 따라서 acf/pacf 계형도 달라지고 각각의 ARIMA모형의 AIC값도 달라졌다.

ARIMA모델(계절요인유무) | AIC값
----------------------- | -----
ARIMA(1,1,0)(Seasonal)  | 1506.73
ARIMA(1,1,0)(No_Seasonal) | 1591.57
ARIMA(0,1,1)(Seasonal) | 1507.06
ARIMA(0,1,1)(NO_Seasonal) | 1496.59
ARIMA(1,1,1)(Seasonal) | 1508.07
ARIMA(1,1,1)(No_Seasonal) | 1494.3
ARIMA(0,1,1)(0,0,1)[4] with drift | 1498.73

ARIMA(1,1,1)(No_Seasonal)의 AIC값이 제일 작으므로 위에 모델중에서는 ARIMA(1,1,1)(No_Seasonal)이 가장 적합한 모델이라고 할 수 있다. 하지만 또 다른 조건을 추가하고 빼고 차분하다보면 더 좋은 모델을 찾을 수 있다. 

따라서 가장 완벽한 모델을 찾기 위해서는 조건을 잘 다뤄야 가장 값들을 만족시키는 모델을 만들 수 있다.

하지만 그 조건은 더 심화학습(전공) 필요한 부분이기 때문에 여기까지 설명하겠다.


***

참고 :
https://otexts.com/fppkr/stationarity.html#fn15
